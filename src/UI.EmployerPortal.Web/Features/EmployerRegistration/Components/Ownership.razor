@rendermode InteractiveServer
@using UI.EmployerPortal.Web.Features.EmployerRegistration.Models
@using UI.EmployerPortal.Web.Features.EmployerRegistration.Components.OwnershipForms

<div class="ownership-container">
    <h1 class="ownership-title">Ownership</h1>
    
    @if (!string.IsNullOrEmpty(OwnershipType) && GetCurrentConfig() != null)
    {
        <p class="required-note">@GetRequiredFieldsMessage()</p>
    }
    else
    {
        <p class="required-note">All fields are required unless noted</p>
    }
    <form>
        <div class="form-section">
            <!-- Ownership Type -->
            <div class="form-group">
                <label for="ownership-type" class="form-label">Ownership Type</label>
                <select id="ownership-type" class="form-select form-select-medium" @bind="OwnershipType" @bind:after="OnOwnershipTypeChanged">
                    <option value="">Select Ownership Type</option>
                    <option value="llc">Limited Liability Company (LLC)</option>
                    <option value="llc-corporation">LLC Electing to be Treated as a Corporation</option>
                    <option value="sole-proprietorship">Sole Proprietorship (not LLC or Corporation)</option>
                    <option value="corporation">Corporation</option>
                    <option value="partnership">Partnership (not LLC or Corporation)</option>
                    <option value="llp">Limited Liability Partnership (LLP)</option>
                    <option value="lp">Limited Partnership (LP)</option>
                    <option value="association">Association</option>
                    <option value="cooperative">Cooperative</option>
                    <option value="estate">Estate</option>
                    <option value="fiduciary">Fiduciary</option>
                    <option value="individual">Individual</option>
                    <option value="joint-venture">Joint Venture</option>
                    <option value="qsf">Qualified Settlement Fund (QSF)</option>
                </select>
            </div>

            <!-- Headquartered Outside USA Checkbox -->
            <div class="checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" @bind="IsOutsideUSA" />
                    <span>The business is headquartered outside of the United States</span>
                </label>
            </div>

            @* Render dynamic component based on ownership type *@
            @if (!string.IsNullOrEmpty(OwnershipType) && _ownershipComponentMap.ContainsKey(OwnershipType))
            {   
                <DynamicComponent Type="@_ownershipComponentMap[OwnershipType]" 
                                  Parameters="@GetComponentParameters()" />
            }
        </div>

        <!-- Navigation Buttons -->
        <div class="form-actions">
            <button type="button" class="btn btn-back" @onclick="OnBack">
                <span class="btn-icon">‹</span> BACK
            </button>
            <button type="button" class="btn btn-save" @onclick="OnSaveAndQuit">
                SAVE & QUIT
            </button>
            <button type="button" class="btn btn-continue" @onclick="OnContinue">
                CONTINUE <span class="btn-icon">›</span>
            </button>
        </div>
    </form>
</div>
